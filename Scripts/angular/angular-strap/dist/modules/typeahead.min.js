/**
 * angular-strap
 * @version v2.0.5 - 2014-08-07
 * @link http://mgcrea.github.io/angular-strap
 * @author Olivier Louvignes (olivier@mg-crea.com)
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
angular.module("mgcrea.ngStrap.typeahead",["mgcrea.ngStrap.tooltip","mgcrea.ngStrap.helpers.parseOptions"]).provider("$typeahead",function(){var n=this.defaults={animation:"am-fade",prefixClass:"typeahead",prefixEvent:"$typeahead",placement:"bottom-left",template:"typeahead/typeahead.tpl.html",trigger:"focus",container:!1,keyboard:!0,html:!1,delay:0,minLength:1,filter:"filter",limit:6};this.$get=["$window","$rootScope","$tooltip",function(t,i,r){function u(t,i,u){var e={},o=angular.extend({},n,u),s,f,h,c;return e=r(t,o),s=u.scope,f=e.$scope,f.$resetMatches=function(){f.$matches=[];f.$activeIndex=0},f.$resetMatches(),f.$activate=function(n){f.$$postDigest(function(){e.activate(n)})},f.$select=function(n){f.$$postDigest(function(){e.select(n)})},f.$isVisible=function(){return e.$isVisible()},e.update=function(n){f.$matches=n;f.$activeIndex>=n.length&&(f.$activeIndex=0)},e.activate=function(n){f.$activeIndex=n},e.select=function(n){var t=f.$matches[n].value;i.$setViewValue(t);i.$render();f.$resetMatches();s&&s.$digest();f.$emit(o.prefixEvent+".select",t,n)},e.$isVisible=function(){return!o.minLength||!i?!!f.$matches.length:f.$matches.length&&angular.isString(i.$viewValue)&&i.$viewValue.length>=o.minLength},e.$getIndex=function(n){var i=f.$matches.length,t=i;if(i){for(t=i;t--;)if(f.$matches[t].value===n)break;if(!(t<0))return t}},e.$onMouseDown=function(n){n.preventDefault();n.stopPropagation()},e.$onKeyDown=function(n){/(38|40|13)/.test(n.keyCode)&&(e.$isVisible()&&(n.preventDefault(),n.stopPropagation()),n.keyCode===13&&f.$matches.length?e.select(f.$activeIndex):n.keyCode===38&&f.$activeIndex>0?f.$activeIndex--:n.keyCode===40&&f.$activeIndex<f.$matches.length-1?f.$activeIndex++:angular.isUndefined(f.$activeIndex)&&(f.$activeIndex=0),f.$digest())},h=e.show,e.show=function(){h();setTimeout(function(){e.$element.on("mousedown",e.$onMouseDown);if(o.keyboard)t.on("keydown",e.$onKeyDown)})},c=e.hide,e.hide=function(){e.$element.off("mousedown",e.$onMouseDown);o.keyboard&&t.off("keydown",e.$onKeyDown);c()},e}var f=angular.element(t.document.body);return u.defaults=n,u}]}).directive("bsTypeahead",["$window","$parse","$q","$typeahead","$parseOptions",function(n,t,i,r,u){var f=r.defaults;return{restrict:"EAC",require:"ngModel",link:function(n,t,i,e){var s={scope:n},c,o,v;angular.forEach(["placement","container","delay","trigger","keyboard","html","animation","template","filter","limit","minLength","watchOptions","selectMode","test"],function(n){angular.isDefined(i[n])&&(s[n]=i[n])});var a=s.filter||f.filter,h=s.limit||f.limit,l=i.ngOptions;a&&(l+=" | "+a+":$viewValue");h&&(l+=" | limitTo:"+h);c=u(l);o=r(t,e,s);s.watchOptions&&(v=c.$match[7].replace(/\|.+/,"").replace(/\(.*\)/g,"").trim(),n.$watch(v,function(){c.valuesFn(n,e).then(function(n){o.update(n);e.$render()})},!0));n.$watch(i.ngModel,function(t){n.$modelValue=t;c.valuesFn(n,e).then(function(n){if(s.selectMode&&!n.length&&t.length>0){e.$setViewValue(e.$viewValue.substring(0,e.$viewValue.length-1));return}n.length>h&&(n=n.slice(0,h));var i=o.$isVisible();(i&&o.update(n),n.length!==1||n[0].value!==t)&&(i||o.update(n),e.$render())})});e.$render=function(){if(e.$isEmpty(e.$viewValue))return t.val("");var i=o.$getIndex(e.$modelValue),n=angular.isDefined(i)?o.$scope.$matches[i].label:e.$viewValue;n=angular.isObject(n)?n.label:n;t.val(n.replace(/<(?:.|\n)*?>/gm,"").trim())};n.$on("$destroy",function(){o.destroy();s=null;o=null})}}}]);
/*
//# sourceMappingURL=typeahead.min.js.map
*/